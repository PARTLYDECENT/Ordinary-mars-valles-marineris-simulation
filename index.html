<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mars Colony Command: Valles Marineris Edition</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="tooltip" class="tooltip"></div>

    <div id="side-panel">
        <div id="panel-toggle" onclick="togglePanel()">«</div>
        <div class="tab-nav">
            <button class="tab-button active" onclick="openTab('status')">Status</button>
            <button class="tab-button" onclick="openTab('resources')">Resources</button>
            <button class="tab-button" onclick="openTab('production')">Production</button>
            <button class="tab-button" onclick="openTab('build')">Build</button>
            <button class="tab-button" onclick="openTab('log')">Log</button>
        </div>
        <div class="tab-content">
            <div id="status-pane" class="tab-pane active">
                <h3>ENVIRONMENTAL STATUS</h3>
                <div class="metric"><span class="metric-label">Sol:</span><span id="sol" class="metric-value">1</span></div>
                <div class="metric"><span class="metric-label">Temperature:</span><span id="temp" class="metric-value">-62°C</span></div>
                <div class="metric"><span class="metric-label">Wind Speed:</span><span id="wind" class="metric-value">12 kph</span></div>
                <div class="metric"><span class="metric-label">Weather:</span><span id="weather-status" class="metric-value success-text">NOMINAL</span></div>
                <h3 class="mt-6">POWER GRID</h3>
                <div class="metric"><span class="metric-label">Solar Output:</span><span id="solar-output" class="metric-value">0 W</span></div>
                <div class="metric"><span class="metric-label">Consumption:</span><span id="total-consumption" class="metric-value">0 W</span></div>
                <div class="metric"><span class="metric-label">Battery:</span> <span id="battery-charge-value" class="metric-value"></span></div>
                <div class="progress-bar-container"><div id="battery-bar" class="progress-bar"></div></div>
                <h3 class="mt-6">MISSION OBJECTIVE</h3>
                <div class="text-xs mb-2">Construct 20 solar panels to secure the colony's power grid.</div>
                <div class="metric"><span class="metric-label">Solar Panels Built:</span><span id="mission-panels-progress" class="metric-value"></span></div>
                <div class="progress-bar-container"><div id="mission-panels-bar" class="progress-bar"></div></div>
            </div>
            <div id="resources-pane" class="tab-pane">
                <h3>RESOURCE INVENTORY</h3>
                <div class="metric"><span class="metric-label">Oxygen:</span><span id="oxygen" class="metric-value"></span></div>
                <div class="progress-bar-container"><div id="oxygen-bar" class="progress-bar"></div></div>
                <div class="metric"><span class="metric-label">Water:</span><span id="water" class="metric-value"></span></div>
                <div class="progress-bar-container"><div id="water-bar" class="progress-bar"></div></div>
                <div class="metric"><span class="metric-label">Regolith:</span><span id="regolith" class="metric-value"></span></div>
                <div class="metric"><span class="metric-label">Iron Ore:</span><span id="iron-ore" class="metric-value"></span></div>
                <div class="metric"><span class="metric-label">Iron Plates:</span><span id="iron-plates" class="metric-value"></span></div>
                <div class="metric"><span class="metric-label">Electronics:</span><span id="electronics" class="metric-value"></span></div>
            </div>
            <div id="production-pane" class="tab-pane">
                <h3>SYSTEM CONTROLS</h3>
                <button class="btn" onclick="advanceTime()">Advance Sol</button>
                <button class="btn" onclick="toggleStorm()">Toggle Storm</button>
                <button class="btn" onclick="deployRover()">Deploy Rover</button>
                <button class="btn" onclick="toggleWindSound()">Toggle Wind</button>
                <h3 class="mt-6">MANUFACTURING</h3>
                <button class="btn" onclick="interactWithStructure('refinery')">Refine Regolith (20R)</button>
                <button class="btn" onclick="interactWithStructure('arc_furnace')">Smelt Plates (8 Ore)</button>
                <button class="btn" onclick="interactWithStructure('fabricator')">Craft Electronics (2P, 2R)</button>
                <button class="btn" onclick="interactWithStructure('habitat_module', 'electrolysis')">Electrolysis (15W)</button>
            </div>
            <div id="build-pane" class="tab-pane">
                <h3>COLONY CONSTRUCTION</h3>
                <button id="build-panel-btn" class="btn" onclick="buildSolarPanel()">Build Solar Panel (5P, 3E)</button>
                <button id="upgrade-lifesupport-btn" class="btn" onclick="attemptUpgrade('improvedLifeSupport')">Upgrade Life Support (10P, 5E)</button>
                <button id="upgrade-battery-btn" class="btn" onclick="attemptUpgrade('batteryExpansion')">Expand Battery (20P, 10E)</button>
            </div>
            <div id="log-pane" class="tab-pane">
                 <h3>MISSION LOG</h3>
                 <div id="console" class="console"></div>
            </div>
        </div>
    </div>

    <script type="importmap">{"imports": {"three": "https://cdn.jsdelivr.net/npm/three@0.164.1/build/three.module.js", "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.164.1/examples/jsm/"}}</script>
    <script type="module" src="main.js"></script>
</body>
</html>
